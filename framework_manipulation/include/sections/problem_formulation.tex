\section{Modeling and Problem Formulation} \label{sec:formulation}

In this work we consider the challenging task of manipulating articulated objects\footnote{We define articulated objects as unactuated objects composed of more than one rigid part connected by joints allowing rotations or translations.} with a mobile manipulator through \textit{non-prehensile manipulation}. We define $\configRobot \in \nR{\robotDoF}$ and $\dconfigRobot \in \nR{\robotDoF}$ as the vectors of the robot configuration and its time derivative, respectively, where $\robotDoF \in \nN{}_{>0}$ is the robot's DOF.
Similarly, we describe the object configuration and corresponding time derivative by $\configObject \in \nR{\objectDoF}$ and $\dconfigObject \in \nR{\objectDoF}$, respectively, where $\objectDoF \in \nN{}_{>0}$ is the object's DOF. The system input $\command  \in \nR{\robotDoF}$ are the desired robot joint velocities $\dconfigRobotDesired$. The state vector is defined by,
\begin{equation}
    \state = [\configRobot^\transpose \vSpace 
      \dconfigRobot^\transpose \vSpace 
      \configObject^\transpose \vSpace
      \dconfigObject^\transpose ]^\transpose  \in \nR{2(\robotDoF + \objectDoF)}.
\end{equation}
The time evolution of the state is described by the following equation of motion:
\begin{equation} \label{eq:eom}
    \dstate = f(\state, \command) =  
    \begin{bmatrix}
      \dconfigRobot \\
      \matr{M}_r^{-1}(\matr{J}_{r}^\transpose \vect{f}_{ext} - \robotCoriolis + \vect{\tau}_{ctrl}(\command)) \\
      \dconfigObject \\
      \matr{M}_o^{-1}(-\matr{J}_{o}^\transpose \vect{f}_{ext} - \objectCoriolis)
    \end{bmatrix},
\end{equation}
where $\matr{M}_r \in \nR{\robotDoF \times \robotDoF}$ and $\matr{M}_o \in \nR{\objectDoF \times \objectDoF}$ represent the inertia matrices while $\matr{J}_r(\configRobot) \in \nR{\robotDoF \times 3}$ and $\matr{J}_o(\configObject) \in \nR{\objectDoF \times 3}$ are the Jacobians at the robot and object contact point\footnote{Without loss of generality we consider single contacts to simplify the notation. Nevertheless, extension to the multi-contact case is straightforward.}, respectively.
$\matr{J}_r$ and $\matr{J}_o$ map the interaction force $\vect{f}_{ext} \in \nR{3}$ at the contact point into the efforts at the object and robot joints. Coriolis and gravity terms are denoted as $\robotCoriolis$ and $\objectCoriolis$. 
The joint torques, denoted by $\vect{\tau}_{ctrl}$, are computed by a velocity low-level controller as a function of the velocity references $\command$. We define with  $\mathcal{X} \subseteq \nR{2(\robotDoF + \objectDoF)}$ and $\mathcal{U} \subseteq \nR{\robotDoF}$ the spaces of admissible states and inputs, respectively. The control objective is to minimize the distance from an initial to final desired configuration through a feedback policy $\policy(\vect{x}_t)$ where $\boldsymbol{\theta}$ are the policy parameters and $T$ is the length of the receding time horizon. The \textit{distance} to the goal configuration must be defined for the specific problem and can be computed in a space different to $\mathcal{X}$ via an opportune mapping $h : \mathcal{X} \rightarrow \mathcal{H}$: 

\begin{equation} \label{eq:objective}
\begin{aligned}
\underset{\policy}{\arg \min}&  \lim_{t \rightarrow \infty} || h(\state^*) - h(\state(t)) ||\\
\text{subject to: } & \dstate_t=f(\state_t, \command_t) \quad \forall \ t\\
                    & \state_t  \in \mathcal{X}         \quad \forall \ t \\
                    & \command_t \in \mathcal{U}        \quad \forall \ t
\end{aligned}
\end{equation}

As an example, the manipulation task that we analyse consists of moving an articulated object to a desired configuration. In this case the objective in \eqref{eq:objective} can be defined by:


\begin{equation}
   || h(\state^*) - h(\state(t)) || = || \configObject^* - \configObject ||_2,
\end{equation}
with $\configObject^*$ as the desired final configuration of the object. The minimization of the objective in \eqref{eq:objective} requires solving a complex optimization in a high dimensional and non-linear space. To facilitate the task, additional \textit{surrogate objectives} are defined to introduce some bias towards the optimal solution. These objectives will appear as additional \textit{cost terms} that penalize specific configurations. The separate terms will be presented and explained in Section~\ref{sec:control_method}.
